2025-10-23 13:43:20,402 - experiments.framework - INFO - ExperimentFramework initialized with output dir: /cs/student/msc/aibh/2024/madhavan/sgfa_qmap-pd/results/all_rois-sn_conf-age+sex+tiv_K5_percW33_MAD1000.0_run_20251023_134320
2025-10-23 13:43:20,413 - experiments.framework - INFO - Starting experiment: data_validation_20251023_134320
2025-10-23 13:43:20,413 - experiments.data_validation - INFO - Running comprehensive data validation...
2025-10-23 13:43:20,414 - experiments.data_validation - INFO - Auto-configured system: 22.2GB memory limit
2025-10-23 13:43:20,415 - experiments.data_validation - INFO - ExperimentFramework initialized with output dir: results
2025-10-23 13:43:20,416 - experiments.data_validation - INFO - Auto-configured system: 22.2GB memory limit
2025-10-23 13:43:20,416 - experiments.data_validation - INFO - Memory optimizer initialized with 22.2GB limit
2025-10-23 13:43:20,416 - experiments.data_validation - INFO - Data streaming components initialized
2025-10-23 13:43:20,416 - experiments.data_validation - INFO - MCMC memory optimizer initialized
2025-10-23 13:43:20,417 - experiments.data_validation - INFO - Running data quality assessment
2025-10-23 13:43:20,417 - experiments.data_validation - INFO - Loading qMAP-PD data for quality assessment...
2025-10-23 13:43:20,417 - experiments.data_validation - INFO -    ROI selection: ['volume_sn_voxels.tsv']
2025-10-23 13:43:20,417 - experiments.data_validation - INFO -    Confound regression: ['age', 'sex', 'tiv']
2025-10-23 13:43:20,417 - experiments.data_validation - INFO -    Feature selection: none
2025-10-23 13:43:20,429 - root - INFO - Loading selected ROIs: ['volume_sn_voxels.tsv']
2025-10-23 13:43:20,578 - root - INFO - Preprocessing module imported successfully
2025-10-23 13:43:20,581 - root - INFO - Regressing out confounds: ['age', 'sex', 'tiv']
2025-10-23 13:43:20,590 - root - INFO -   Regressed confounds from volume_sn_voxels: ['age', 'sex', 'tiv']
2025-10-23 13:43:20,590 - root - INFO -   Dropped 3 confound features from clinical: ['age', 'sex', 'tiv']
2025-10-23 13:43:20,590 - root - INFO -   Remaining clinical features: 14
2025-10-23 13:43:20,590 - experiments.data_validation - INFO -    PCA enabled in preprocessing_config: False
2025-10-23 13:43:20,602 - root - INFO - Loading selected ROIs: ['volume_sn_voxels.tsv']
2025-10-23 13:43:20,829 - root - INFO - Starting neuroimaging-aware preprocessing pipeline
2025-10-23 13:43:20,829 - root - INFO - MAD filtering disabled for volume_sn_voxels (threshold=1000.0)
2025-10-23 13:43:20,841 - root - INFO - Applying none feature selection to volume_sn_voxels
2025-10-23 13:43:20,841 - root - INFO - Applying robust scaling to volume_sn_voxels
2025-10-23 13:43:20,958 - root - INFO - Filtered position lookup for volume_sn_voxels: 1794 ‚Üí 1794 positions (100.0% retained)
2025-10-23 13:43:20,964 - root - INFO - Saved filtered position lookup to /cs/student/msc/aibh/2024/madhavan/sgfa_qmap-pd/results/all_rois-sn_conf-age+sex+tiv_K5_percW33_MAD1000.0_run_20251023_134320/data_validation_tree10_20251023_134320/position_lookup_filtered/position_sn_voxels_filtered.tsv
2025-10-23 13:43:20,966 - root - INFO - Applying none feature selection to clinical
2025-10-23 13:43:20,966 - root - INFO - Applying robust scaling to clinical
2025-10-23 13:43:20,968 - root - INFO - Regressing out confounds: ['age', 'sex', 'tiv']
2025-10-23 13:43:20,972 - root - INFO -   Regressed confounds from volume_sn_voxels: ['age', 'sex', 'tiv']
2025-10-23 13:43:20,972 - root - INFO -   Dropped 3 confound features from clinical: ['age', 'sex', 'tiv']
2025-10-23 13:43:20,972 - root - INFO -   Remaining clinical features: 14
2025-10-23 13:43:20,972 - experiments.data_validation - INFO -    ‚úÖ Filtered position lookups saved to: /cs/student/msc/aibh/2024/madhavan/sgfa_qmap-pd/results/all_rois-sn_conf-age+sex+tiv_K5_percW33_MAD1000.0_run_20251023_134320/data_validation_tree10_20251023_134320/position_lookup_filtered
2025-10-23 13:43:20,972 - experiments.data_validation - INFO -    Creating filtered position lookups with output_dir: /cs/student/msc/aibh/2024/madhavan/sgfa_qmap-pd/results/all_rois-sn_conf-age+sex+tiv_K5_percW33_MAD1000.0_run_20251023_134320/data_validation_tree10_20251023_134320
2025-10-23 13:43:20,972 - experiments.data_validation - INFO -   _create_filtered_position_lookups called:
2025-10-23 13:43:20,972 - experiments.data_validation - INFO -     view_names: ['volume_sn_voxels', 'clinical']
2025-10-23 13:43:20,973 - experiments.data_validation - INFO -     n_views raw: 2, preprocessed: 2
2025-10-23 13:43:20,973 - experiments.data_validation - INFO -   Creating filtered position lookup for volume_sn_voxels...
2025-10-23 13:43:20,975 - experiments.data_validation - INFO -   Original positions: 1794 rows
2025-10-23 13:43:20,975 - experiments.data_validation - INFO -   Raw data: 1794 voxels
2025-10-23 13:43:20,976 - experiments.data_validation - INFO -   Preprocessed data: 1794 voxels
2025-10-23 13:43:20,976 - experiments.data_validation - INFO -   No voxels dropped, position lookup unchanged
2025-10-23 13:43:20,986 - experiments.data_validation - INFO -   ‚úÖ Saved filtered position lookup: /cs/student/msc/aibh/2024/madhavan/sgfa_qmap-pd/results/all_rois-sn_conf-age+sex+tiv_K5_percW33_MAD1000.0_run_20251023_134320/data_validation_tree10_20251023_134320/filtered_position_lookups/sn_filtered_position_lookup.csv
2025-10-23 13:43:20,986 - experiments.data_validation - INFO -      1794 ‚Üí 1794 rows
2025-10-23 13:43:20,986 - experiments.data_validation - INFO -   Skipping clinical view
2025-10-23 13:43:20,986 - experiments.data_validation - INFO -    ‚úÖ Filtered position lookups saved to: /cs/student/msc/aibh/2024/madhavan/sgfa_qmap-pd/results/all_rois-sn_conf-age+sex+tiv_K5_percW33_MAD1000.0_run_20251023_134320/data_validation_tree10_20251023_134320/filtered_position_lookups
2025-10-23 13:43:20,986 - experiments.data_validation - INFO -    Files created: ['/cs/student/msc/aibh/2024/madhavan/sgfa_qmap-pd/results/all_rois-sn_conf-age+sex+tiv_K5_percW33_MAD1000.0_run_20251023_134320/data_validation_tree10_20251023_134320/filtered_position_lookups/sn_filtered_position_lookup.csv']
2025-10-23 13:43:20,987 - experiments.data_validation - INFO - Data structure analysis completed. Raw: 1808 features, Processed: 1808 features
2025-10-23 13:43:20,988 - experiments.data_validation - INFO - üîç Assessing data quality metrics...
2025-10-23 13:43:20,988 - experiments.data_validation - INFO -    Analyzing quality metrics for volume_sn_voxels (86√ó1794)...
2025-10-23 13:43:20,994 - experiments.data_validation - INFO -    Analyzing quality metrics for clinical (86√ó14)...
2025-10-23 13:43:20,995 - experiments.data_validation - INFO -       Computing correlation matrix for clinical...
2025-10-23 13:43:20,996 - experiments.data_validation - INFO -    Analyzing quality metrics for volume_sn_voxels (86√ó1794)...
2025-10-23 13:43:21,002 - experiments.data_validation - INFO -    Analyzing quality metrics for clinical (86√ó14)...
2025-10-23 13:43:21,003 - experiments.data_validation - INFO -       Computing correlation matrix for clinical...
2025-10-23 13:43:21,023 - experiments.data_validation - INFO - ================================================================================
2025-10-23 13:43:21,023 - experiments.data_validation - INFO - üîç MAD THRESHOLD EXPLORATORY DATA ANALYSIS
2025-10-23 13:43:21,023 - experiments.data_validation - INFO - ================================================================================
2025-10-23 13:43:21,023 - experiments.data_validation - INFO - Analyzing optimal MAD threshold values for outlier detection...
2025-10-23 13:43:21,023 - experiments.data_validation - INFO - Analyzing 1 imaging views: ['volume_sn_voxels']
2025-10-23 13:43:21,024 - experiments.data_validation - INFO - üìä Analyzing MAD distributions...
2025-10-23 13:43:21,024 - experiments.data_validation - INFO -    Processing volume_sn_voxels: (86, 1794)
2025-10-23 13:43:22,001 - experiments.data_validation - INFO -       Saved MAD distribution plot: mad_distribution_sn.png
2025-10-23 13:43:22,001 - experiments.data_validation - INFO -    ‚úÖ MAD distributions analyzed for 1 views
2025-10-23 13:43:22,001 - experiments.data_validation - INFO - üìà Performing elbow analysis...
2025-10-23 13:43:22,013 - experiments.data_validation - INFO -    volume_sn_voxels: Elbow at 2.26 (7.1% retention)
2025-10-23 13:43:22,424 - experiments.data_validation - INFO -    ‚úÖ Elbow analysis completed, saved to elbow_analysis_all_views.png
2025-10-23 13:43:22,424 - experiments.data_validation - INFO - üó∫Ô∏è  Analyzing spatial distribution of removed voxels...
2025-10-23 13:43:22,426 - experiments.data_validation - INFO -    Loaded position lookup for volume_sn_voxels: 1793 voxels
2025-10-23 13:43:22,426 - experiments.data_validation - WARNING -    Dimension mismatch for volume_sn_voxels: 1794 MAD values vs 1793 positions. Skipping spatial analysis.
2025-10-23 13:43:22,426 - experiments.data_validation - INFO -    ‚úÖ Spatial analysis completed for 1 views
2025-10-23 13:43:22,426 - experiments.data_validation - INFO - üìä Analyzing information preservation...
2025-10-23 13:43:22,426 - experiments.data_validation - INFO -    Processing volume_sn_voxels...
2025-10-23 13:43:23,006 - experiments.data_validation - INFO -       Saved information preservation plot: information_preservation_all_views.png
2025-10-23 13:43:23,006 - experiments.data_validation - INFO -    ‚úÖ Information preservation analyzed for 1 views
2025-10-23 13:43:23,006 - experiments.data_validation - INFO - üë§ Analyzing subject-level data quality...
2025-10-23 13:43:23,006 - experiments.data_validation - INFO -    Processing volume_sn_voxels: (86, 1794)
2025-10-23 13:43:23,276 - experiments.data_validation - INFO -       Mean outlier %: 1.1%
2025-10-23 13:43:23,276 - experiments.data_validation - INFO -       Max outlier %: 17.5%
2025-10-23 13:43:23,744 - experiments.data_validation - INFO -       Saved subject outlier distribution plot: subject_outlier_distributions.png
2025-10-23 13:43:23,746 - experiments.data_validation - INFO -       Saved flagged subjects table: flagged_subjects.csv (2 subjects)
2025-10-23 13:43:23,748 - experiments.data_validation - INFO -       Saved flagged subjects report: flagged_subjects_report.txt
2025-10-23 13:43:24,072 - experiments.data_validation - INFO -       Saved subject outlier comparison plot: subject_outlier_comparison.png
2025-10-23 13:43:24,584 - experiments.data_validation - INFO -       Saved subject outlier scatter plot: subject_outlier_scatter.png
2025-10-23 13:43:25,334 - experiments.data_validation - INFO -       Saved top subjects bar chart: subject_outlier_top20.png
2025-10-23 13:43:25,334 - experiments.data_validation - INFO -    ‚úÖ Subject-level analysis completed: 2 subjects flagged
2025-10-23 13:43:25,334 - experiments.data_validation - INFO - üìã Generating threshold comparison summary...
2025-10-23 13:43:25,337 - experiments.data_validation - INFO -    Saved summary table: mad_threshold_summary_table.csv
2025-10-23 13:43:25,339 - experiments.data_validation - INFO -    üìù Saved recommendations: mad_threshold_recommendations.txt
2025-10-23 13:43:25,340 - experiments.data_validation - INFO - ================================================================================
2025-10-23 13:43:25,340 - experiments.data_validation - INFO - ‚úÖ MAD threshold EDA completed successfully
2025-10-23 13:43:25,340 - experiments.data_validation - INFO - ================================================================================
2025-10-23 13:43:25,340 - experiments.data_validation - INFO - üìä Generating data validation plots...
2025-10-23 13:43:25,340 - experiments.data_validation - INFO -    Creating distribution histograms for 1 clinical view(s), skipping 1 imaging views
2025-10-23 13:43:25,467 - experiments.data_validation - INFO -    ‚úÖ Distribution histograms created (stored as data_distribution_comparison)
2025-10-23 13:43:25,474 - experiments.data_validation - INFO - üìä Basic data validation plots completed: 1 plots generated
2025-10-23 13:43:25,474 - experiments.data_validation - INFO - üé® Creating comprehensive data validation visualizations for data_quality_assessment
2025-10-23 13:43:25,481 - visualization.preprocessing_plots - INFO - Creating preprocessing plots
2025-10-23 13:43:26,013 - visualization.preprocessing_plots - INFO - Saved: results/plots/preprocessing/feature_reduction.png
2025-10-23 13:43:26,615 - visualization.preprocessing_plots - INFO - Saved: results/plots/preprocessing/variance_distribution.png
2025-10-23 13:43:26,616 - visualization.covariance_plots - INFO - ================================================================================
2025-10-23 13:43:26,616 - visualization.covariance_plots - INFO - COVARIANCE STRUCTURE ANALYSIS
2025-10-23 13:43:26,616 - visualization.covariance_plots - INFO - ================================================================================
2025-10-23 13:43:26,723 - visualization.covariance_plots - INFO - Intra-modality covariance for volume_sn_voxels: 1794x1794
2025-10-23 13:43:26,724 - visualization.covariance_plots - INFO - Intra-modality covariance for clinical: 14x14
2025-10-23 13:43:26,783 - visualization.covariance_plots - INFO - Inter-modality covariance for volume_sn_voxels_vs_clinical: 1794x14
2025-10-23 13:43:26,887 - visualization.covariance_plots - INFO - 
Data structure:
2025-10-23 13:43:26,887 - visualization.covariance_plots - INFO -   Number of views: 2
2025-10-23 13:43:26,887 - visualization.covariance_plots - INFO -   Number of samples: 86
2025-10-23 13:43:26,888 - visualization.covariance_plots - INFO -   volume_sn_voxels: 1794 features
2025-10-23 13:43:26,888 - visualization.covariance_plots - INFO -   clinical: 14 features
2025-10-23 13:43:26,888 - visualization.covariance_plots - INFO - 
Intra-modality correlation statistics:
2025-10-23 13:43:26,888 - visualization.covariance_plots - INFO -   volume_sn_voxels:
2025-10-23 13:43:26,888 - visualization.covariance_plots - INFO -     Mean correlation: 0.388
2025-10-23 13:43:26,888 - visualization.covariance_plots - INFO -     Std correlation: 0.219
2025-10-23 13:43:26,888 - visualization.covariance_plots - INFO -     Max |correlation|: 0.994
2025-10-23 13:43:26,888 - visualization.covariance_plots - INFO -   clinical:
2025-10-23 13:43:26,888 - visualization.covariance_plots - INFO -     Mean correlation: 0.073
2025-10-23 13:43:26,888 - visualization.covariance_plots - INFO -     Std correlation: 0.350
2025-10-23 13:43:26,888 - visualization.covariance_plots - INFO -     Max |correlation|: 0.911
2025-10-23 13:43:26,888 - visualization.covariance_plots - INFO - 
Inter-modality correlation statistics:
2025-10-23 13:43:26,888 - visualization.covariance_plots - INFO -   volume_sn_voxels_vs_clinical:
2025-10-23 13:43:26,888 - visualization.covariance_plots - INFO -     Mean correlation: 0.031
2025-10-23 13:43:26,888 - visualization.covariance_plots - INFO -     Std correlation: 0.121
2025-10-23 13:43:26,888 - visualization.covariance_plots - INFO -     Max |correlation|: 0.371
2025-10-23 13:43:26,888 - visualization.covariance_plots - INFO - 
Generating covariance plots...
2025-10-23 13:43:26,888 - visualization.covariance_plots - INFO - Subsampling covariance matrix from 1808 to 500 features
2025-10-23 13:43:28,159 - visualization.covariance_plots - INFO - Saved block covariance matrix plot to results/plots/block_covariance_matrix.png
2025-10-23 13:43:36,638 - visualization.covariance_plots - INFO - Saved inter/intra comparison plot to results/plots/inter_vs_intra_correlation.png
2025-10-23 13:43:36,639 - visualization.covariance_plots - INFO - Plots saved to results/plots
2025-10-23 13:43:36,639 - visualization.covariance_plots - INFO - ================================================================================
2025-10-23 13:43:36,644 - experiments.data_validation - INFO -    Found 4 plot files to convert
2025-10-23 13:43:37,375 - experiments.data_validation - INFO -    ‚úÖ Created 4 comprehensive data validation visualizations
2025-10-23 13:43:37,375 - experiments.data_validation - INFO - üé® Comprehensive data validation plots completed: 4 advanced plots generated
2025-10-23 13:43:37,375 - experiments.data_validation - INFO - üìä Total plots ready for saving: 5
2025-10-23 13:43:37,376 - experiments.data_validation - INFO - üìÅ Using experiment output dir: /cs/student/msc/aibh/2024/madhavan/sgfa_qmap-pd/results/all_rois-sn_conf-age+sex+tiv_K5_percW33_MAD1000.0_run_20251023_134320/data_validation_tree10_20251023_134320
2025-10-23 13:43:46,255 - core.io_utils - INFO - Saved 5 plots individually to /cs/student/msc/aibh/2024/madhavan/sgfa_qmap-pd/results/all_rois-sn_conf-age+sex+tiv_K5_percW33_MAD1000.0_run_20251023_134320/data_validation_tree10_20251023_134320/individual_plots (0 skipped)
2025-10-23 13:43:46,256 - core.io_utils - INFO -   Formats: png, pdf
2025-10-23 13:43:46,256 - experiments.data_validation - INFO - ‚úÖ Saved 5 individual plots to /cs/student/msc/aibh/2024/madhavan/sgfa_qmap-pd/results/all_rois-sn_conf-age+sex+tiv_K5_percW33_MAD1000.0_run_20251023_134320/data_validation_tree10_20251023_134320/individual_plots
2025-10-23 13:43:46,256 - experiments.data_validation - INFO - ‚úÖ Data validation with EDA completed!
2025-10-23 13:43:46,256 - experiments.data_validation - INFO -    Plots generated: 5
2025-10-23 13:43:46,256 - experiments.framework - INFO - üèÅ EXPERIMENT COMPLETED: data_validation_20251023_134320
2025-10-23 13:43:46,256 - experiments.framework - INFO - ‚è±Ô∏è  TOTAL RUNTIME: 25.9 seconds
2025-10-23 13:43:46,256 - experiments.framework - INFO - üïê Started: 2025-10-23 13:43:20
2025-10-23 13:43:46,256 - experiments.framework - INFO - üïë Finished: 2025-10-23 13:43:46
2025-10-23 13:43:46,256 - experiments.framework - INFO - Experiment completed successfully: data_validation_20251023_134320
2025-10-23 13:43:46,256 - experiments.framework - INFO - üßπ Performing comprehensive memory cleanup...
2025-10-23 13:43:46,339 - experiments.framework - INFO - Garbage collection freed 0 objects
2025-10-23 13:43:46,633 - experiments.framework - INFO - GPU memory cleanup attempted
2025-10-23 13:43:47,634 - experiments.framework - INFO - ‚úÖ Comprehensive memory cleanup completed
