2025-10-23 00:42:26,765 - experiments.framework - INFO - ExperimentFramework initialized with output dir: /cs/student/msc/aibh/2024/madhavan/sgfa_qmap-pd/results/all_rois-sn_conf-age+sex+tiv_K5_percW33_MAD1000.0_run_20251023_004226
2025-10-23 00:42:26,769 - experiments.framework - INFO - Starting experiment: data_validation_20251023_004226
2025-10-23 00:42:26,769 - experiments.data_validation - INFO - Running comprehensive data validation...
2025-10-23 00:42:26,769 - optimization.config - INFO - Configuration optimized for system: 56.1GB RAM, 24 CPUs
2025-10-23 00:42:26,769 - experiments.data_validation - INFO - Auto-configured system: 44.9GB memory limit
2025-10-23 00:42:26,769 - experiments.data_validation - INFO - ExperimentFramework initialized with output dir: results
2025-10-23 00:42:26,770 - optimization.config - INFO - Configuration optimized for system: 56.1GB RAM, 24 CPUs
2025-10-23 00:42:26,770 - experiments.data_validation - INFO - Auto-configured system: 44.9GB memory limit
2025-10-23 00:42:26,770 - optimization.memory_optimizer - INFO - MemoryOptimizer initialized: max_memory=44.89GB
2025-10-23 00:42:26,770 - experiments.data_validation - INFO - Memory optimizer initialized with 44.9GB limit
2025-10-23 00:42:26,770 - optimization.memory_optimizer - INFO - MemoryOptimizer initialized: max_memory=44.89GB
2025-10-23 00:42:26,770 - optimization.data_streaming - INFO - DataStreamer initialized: chunk_size=None, memory_limit=44.888980102539065GB
2025-10-23 00:42:26,770 - optimization.memory_optimizer - INFO - MemoryOptimizer initialized: max_memory=44.89GB
2025-10-23 00:42:26,770 - optimization.data_streaming - INFO - DataStreamer initialized: chunk_size=None, memory_limit=44.888980102539065GB
2025-10-23 00:42:26,770 - experiments.data_validation - INFO - Data streaming components initialized
2025-10-23 00:42:26,770 - optimization.memory_optimizer - INFO - MemoryOptimizer initialized: max_memory=44.89GB
2025-10-23 00:42:26,770 - optimization.mcmc_optimizer - INFO - MCMCMemoryOptimizer initialized with 44.888980102539065GB limit
2025-10-23 00:42:26,770 - experiments.data_validation - INFO - MCMC memory optimizer initialized
2025-10-23 00:42:26,770 - experiments.data_validation - INFO - Running data quality assessment
2025-10-23 00:42:26,770 - experiments.data_validation - INFO - Loading qMAP-PD data for quality assessment...
2025-10-23 00:42:26,770 - experiments.data_validation - INFO -    ROI selection: ['volume_sn_voxels.tsv']
2025-10-23 00:42:26,770 - experiments.data_validation - INFO -    Confound regression: ['age', 'sex', 'tiv']
2025-10-23 00:42:26,770 - experiments.data_validation - INFO -    Feature selection: none
2025-10-23 00:42:26,775 - root - INFO - Loading selected ROIs: ['volume_sn_voxels.tsv']
2025-10-23 00:42:26,829 - root - INFO - === Applying Basic Preprocessing ===
2025-10-23 00:42:26,848 - root - INFO - Preprocessing module imported successfully
2025-10-23 00:42:26,849 - root - INFO - Regressing out confounds: ['age', 'sex', 'tiv']
2025-10-23 00:42:26,852 - root - INFO -   Regressed confounds from volume_sn_voxels: ['age', 'sex', 'tiv']
2025-10-23 00:42:26,852 - root - INFO -   Dropped 3 confound features from clinical: ['age', 'sex', 'tiv']
2025-10-23 00:42:26,852 - root - INFO -   Remaining clinical features: 14
2025-10-23 00:42:26,852 - root - INFO - ‚úì Feature names verified for volume_sn_voxels: 1794 features
2025-10-23 00:42:26,852 - root - INFO - ‚úì Feature names verified for clinical: 14 features
2025-10-23 00:42:26,852 - experiments.data_validation - INFO -    PCA enabled in preprocessing_config: False
2025-10-23 00:42:26,867 - root - INFO - Loading selected ROIs: ['volume_sn_voxels.tsv']
2025-10-23 00:42:27,002 - root - INFO - === Applying Advanced Preprocessing ===
2025-10-23 00:42:27,002 - root - INFO - Starting neuroimaging-aware preprocessing pipeline
2025-10-23 00:42:27,002 - root - INFO - Processing view: volume_sn_voxels (shape: (86, 1794))
2025-10-23 00:42:27,002 - root - INFO - MAD filtering disabled for volume_sn_voxels (threshold=1000.0)
2025-10-23 00:42:27,003 - root - INFO - Applying spatial imputation to volume_sn_voxels
2025-10-23 00:42:27,004 - root - INFO - Loaded 1794 voxel positions for sn
2025-10-23 00:42:27,005 - root - INFO - Applying median imputation to volume_sn_voxels
2025-10-23 00:42:27,009 - root - INFO - Applying none feature selection to volume_sn_voxels
2025-10-23 00:42:27,009 - root - INFO - Applying robust scaling to volume_sn_voxels
2025-10-23 00:42:27,055 - experiments.data_validation - ERROR - data_quality_assessment failed: 'NeuroImagingPreprocessor' object has no attribute 'fit_transform_pca'
2025-10-23 00:42:27,055 - experiments.data_validation - INFO - ‚úÖ Data validation with EDA completed!
2025-10-23 00:42:27,055 - experiments.data_validation - INFO -    Plots generated: 0
2025-10-23 00:42:27,055 - experiments.framework - INFO - üèÅ EXPERIMENT COMPLETED: data_validation_20251023_004226
2025-10-23 00:42:27,055 - experiments.framework - INFO - ‚è±Ô∏è  TOTAL RUNTIME: 0.3 seconds
2025-10-23 00:42:27,055 - experiments.framework - INFO - üïê Started: 2025-10-23 00:42:26
2025-10-23 00:42:27,055 - experiments.framework - INFO - üïë Finished: 2025-10-23 00:42:27
2025-10-23 00:42:27,055 - experiments.framework - INFO - Experiment completed successfully: data_validation_20251023_004226
2025-10-23 00:42:27,055 - experiments.framework - INFO - üßπ Performing comprehensive memory cleanup...
2025-10-23 00:42:27,102 - experiments.framework - INFO - Garbage collection freed 0 objects
2025-10-23 00:42:27,238 - experiments.framework - INFO - GPU memory cleanup attempted
2025-10-23 00:42:28,239 - experiments.framework - INFO - ‚úÖ Comprehensive memory cleanup completed
2025-10-23 00:42:28,664 - experiments.framework - INFO - ExperimentFramework initialized with output dir: /cs/student/msc/aibh/2024/madhavan/sgfa_qmap-pd/results/all_rois-sn_conf-age+sex+tiv_K5_percW33_MAD1000.0_run_20251023_004226
2025-10-23 00:42:28,664 - experiments.robustness_testing - INFO -    Using command-line K override: 5 (default is 10)
2025-10-23 00:42:28,664 - experiments.robustness_testing - INFO -    Using global model hyperparameters: K=5, percW=33.0, slab_df=4, slab_scale=2
2025-10-23 00:42:28,664 - experiments.robustness_testing - INFO -    QC outlier threshold (MAD): 1000.0
2025-10-23 00:42:28,664 - experiments.robustness_testing - INFO -    Using model type: sparse_gfa_fixed
2025-10-23 00:42:28,664 - optimization.config - INFO - Configuration optimized for system: 56.0GB RAM, 24 CPUs
2025-10-23 00:42:28,664 - experiments.robustness_testing - INFO - Auto-configured system: 44.8GB memory limit
2025-10-23 00:42:28,666 - experiments.robustness_testing - INFO - ExperimentFramework initialized with output dir: results
2025-10-23 00:42:28,666 - optimization.config - INFO - Configuration optimized for system: 56.0GB RAM, 24 CPUs
2025-10-23 00:42:28,666 - experiments.robustness_testing - INFO - Auto-configured system: 44.8GB memory limit
2025-10-23 00:42:28,666 - optimization.memory_optimizer - INFO - MemoryOptimizer initialized: max_memory=44.84GB
2025-10-23 00:42:28,666 - experiments.robustness_testing - INFO - Memory optimizer initialized with 44.8GB limit
2025-10-23 00:42:28,666 - optimization.memory_optimizer - INFO - MemoryOptimizer initialized: max_memory=44.84GB
2025-10-23 00:42:28,666 - optimization.data_streaming - INFO - DataStreamer initialized: chunk_size=None, memory_limit=44.835809326171876GB
2025-10-23 00:42:28,666 - optimization.memory_optimizer - INFO - MemoryOptimizer initialized: max_memory=44.84GB
2025-10-23 00:42:28,666 - optimization.data_streaming - INFO - DataStreamer initialized: chunk_size=None, memory_limit=44.835809326171876GB
2025-10-23 00:42:28,666 - experiments.robustness_testing - INFO - Data streaming components initialized
2025-10-23 00:42:28,666 - optimization.memory_optimizer - INFO - MemoryOptimizer initialized: max_memory=44.84GB
2025-10-23 00:42:28,666 - optimization.mcmc_optimizer - INFO - MCMCMemoryOptimizer initialized with 44.835809326171876GB limit
2025-10-23 00:42:28,666 - experiments.robustness_testing - INFO - MCMC memory optimizer initialized
2025-10-23 00:42:28,669 - experiments.framework - INFO - Starting experiment: robustness_tests_20251023_004228
2025-10-23 00:42:28,669 - experiments.robustness_testing - INFO - üîÑ Running comprehensive robustness tests...
2025-10-23 00:42:28,670 - experiments.robustness_testing - INFO - üìÅ Set robustness_testing base_output_dir to: /cs/student/msc/aibh/2024/madhavan/sgfa_qmap-pd/results/all_rois-sn_conf-age+sex+tiv_K5_percW33_MAD1000.0_run_20251023_004226/robustness_tests_fixed_K5_percW33_slab4_2_MAD1000.0_tree10_20251023_004228
2025-10-23 00:42:28,670 - experiments.robustness_testing - INFO - üìä Testing seed robustness...
2025-10-23 00:42:28,724 - experiments.robustness_testing - INFO - ================================================================================
2025-10-23 00:42:28,724 - experiments.robustness_testing - INFO - _RUN_SGFA_ANALYSIS - STARTING
2025-10-23 00:42:28,724 - experiments.robustness_testing - INFO - ================================================================================
2025-10-23 00:42:28,724 - experiments.robustness_testing - INFO - Input data: 2 views
2025-10-23 00:42:28,724 - experiments.robustness_testing - INFO -   View 0: shape (86, 1794), dtype float64, has_nan False
2025-10-23 00:42:28,724 - experiments.robustness_testing - INFO -   View 1: shape (86, 14), dtype float64, has_nan False
2025-10-23 00:42:28,725 - experiments.robustness_testing - INFO - Hyperparameters: {'Dm': [1794, 14], 'a_sigma': 1.0, 'b_sigma': 1.0, 'slab_df': 4, 'slab_scale': 2, 'percW': 33.0, 'K': 5}
2025-10-23 00:42:28,725 - experiments.robustness_testing - INFO - MCMC args: {'K': 5, 'num_warmup': 50, 'num_samples': 100, 'num_chains': 1, 'target_accept_prob': 0.8, 'reghsZ': True, 'max_tree_depth': 10, 'use_pca_initialization': True, 'model_type': 'sparse_gfa_fixed', 'random_seed': 42}
2025-10-23 00:42:28,725 - experiments.robustness_testing - INFO - Additional kwargs keys: []
2025-10-23 00:42:28,725 - experiments.robustness_testing - INFO - Running SGFA: K=5, n_subjects=86, n_features=1808
2025-10-23 00:42:28,741 - experiments.robustness_testing - INFO - Setting up model via factory...
2025-10-23 00:42:28,741 - experiments.robustness_testing - INFO - üîç DEBUG: config_dict.get('model_type') = sparse_gfa_fixed
2025-10-23 00:42:28,741 - experiments.robustness_testing - INFO - üîç DEBUG: 'model' in config_dict = False
2025-10-23 00:42:28,741 - experiments.robustness_testing - INFO - üîç DEBUG: args['model_type'] = sparse_gfa_fixed
2025-10-23 00:42:28,741 - experiments.robustness_testing - INFO - üîß Setting K=5 from args into config_dict
2025-10-23 00:42:28,741 - experiments.robustness_testing - INFO - üîç Config model_type: sparse_gfa_fixed
2025-10-23 00:42:28,741 - experiments.robustness_testing - INFO - üîç Config K: 5
2025-10-23 00:42:28,741 - models.models_integration - INFO - üîç DEBUG: model_config keys: ['model_type']
2025-10-23 00:42:28,741 - models.models_integration - INFO - üîç DEBUG: model_type from config: 'sparse_gfa_fixed'
2025-10-23 00:42:28,741 - models.models_integration - INFO - Data characteristics for model selection:
2025-10-23 00:42:28,741 - models.models_integration - INFO -    Total features: 1,808
2025-10-23 00:42:28,741 - models.models_integration - INFO -    Views: 2
2025-10-23 00:42:28,741 - models.models_integration - INFO -    Subjects: 86
2025-10-23 00:42:28,741 - models.models_integration - INFO -    Has imaging data: True
2025-10-23 00:42:28,741 - models.models_integration - INFO - üîç DEBUG: Available Bayesian models: ['GFA', 'neuroGFA', 'sparseGFA', 'sparse_gfa', 'sparse_gfa_fixed', 'standard_gfa']
2025-10-23 00:42:28,741 - models.models_integration - INFO - üîç DEBUG: Checking if 'sparse_gfa_fixed' in bayesian_models: True
2025-10-23 00:42:28,741 - models.models_integration - INFO - ‚úÖ Selected model type: sparse_gfa_fixed
2025-10-23 00:42:28,741 - models.models_integration - INFO - üèóÔ∏è Creating model instance: sparse_gfa_fixed
2025-10-23 00:42:28,741 - models.models_integration - INFO - ‚úÖ Model instance created successfully
2025-10-23 00:42:28,741 - models.models_integration - INFO -    Model type: sparse_gfa_fixed
2025-10-23 00:42:28,741 - models.models_integration - INFO -    Model class: SparseGFAFixedModel
2025-10-23 00:42:28,741 - models.models_integration - INFO - ‚úÖ Models framework integration completed
2025-10-23 00:42:28,741 - models.models_integration - INFO -    Model type: sparse_gfa_fixed
2025-10-23 00:42:28,741 - models.models_integration - INFO -    Model class: SparseGFAFixedModel
2025-10-23 00:42:28,741 - models.models_integration - INFO -    Factory method: True
2025-10-23 00:42:28,741 - models.models_integration - INFO - ‚úÖ Models framework pipeline integration completed
2025-10-23 00:42:28,741 - models.models_integration - INFO -  Model type: sparse_gfa_fixed
2025-10-23 00:42:28,741 - models.models_integration - INFO -  Model factory: True
2025-10-23 00:42:28,741 - models.models_integration - INFO -  Structured management: True
2025-10-23 00:42:28,741 - experiments.robustness_testing - INFO - ‚úÖ Model setup complete: sparse_gfa_fixed
2025-10-23 00:42:28,741 - experiments.robustness_testing - INFO -    Hyperparameters: Dm=[1794, 14], percW=33.0, slab_df=4, slab_scale=2
2025-10-23 00:42:28,741 - experiments.robustness_testing - INFO - ‚úÖ Using model instance: sparse_gfa_fixed
2025-10-23 00:42:28,741 - experiments.robustness_testing - INFO -    Model class: SparseGFAFixedModel
2025-10-23 00:42:28,741 - experiments.robustness_testing - INFO - MCMC configuration: warmup=50, samples=100, chains=1
2025-10-23 00:42:28,741 - experiments.robustness_testing - INFO - Setting up MCMC with seed: 42
2025-10-23 00:42:28,803 - experiments.robustness_testing - INFO - NUTS kernel parameters: target_accept_prob=0.8, max_tree_depth=10, dense_mass=False
2025-10-23 00:42:28,803 - experiments.robustness_testing - INFO -    Using diagonal mass matrix for ~5GB memory savings per chain
2025-10-23 00:42:28,803 - experiments.robustness_testing - INFO - Creating MCMC sampler with chain_method=sequential...
2025-10-23 00:42:28,803 - experiments.robustness_testing - INFO - Creating NUTS kernel for standard MCMC execution...
2025-10-23 00:42:28,804 - core.pca_initialization - INFO - üîß Creating NumPyro initialization parameters...
2025-10-23 00:42:28,804 - core.pca_initialization - INFO -   Model type: sparse_gfa_fixed
2025-10-23 00:42:28,804 - core.pca_initialization - INFO -   K=5, n_views=2
2025-10-23 00:42:28,804 - core.pca_initialization - INFO - üîß Computing PCA initialization...
2025-10-23 00:42:28,804 - core.pca_initialization - INFO -   Input: 2 views, N=86 samples, K=5 factors
2025-10-23 00:42:28,804 - core.pca_initialization - INFO -   View shapes: [(86, 1794), (86, 14)]
2025-10-23 00:42:28,804 - core.pca_initialization - INFO -   Concatenated data shape: (86, 1808)
2025-10-23 00:42:28,804 - core.pca_initialization - INFO - Computing PCA initialization for K=5 factors
2025-10-23 00:42:28,804 - core.pca_initialization - INFO -   Data shape: (86, 1808) (86 samples, 1808 total features)
2025-10-23 00:42:28,804 - core.pca_initialization - INFO -   Number of views: 2
2025-10-23 00:42:28,814 - core.pca_initialization - INFO -   PCA initialization computed:
2025-10-23 00:42:28,815 - core.pca_initialization - INFO -     Z shape: (86, 5)
2025-10-23 00:42:28,815 - core.pca_initialization - INFO -     W shape: (1808, 5)
2025-10-23 00:42:28,815 - core.pca_initialization - INFO -     Variance explained: 69.62%
2025-10-23 00:42:28,815 - core.pca_initialization - INFO -     Per-component variance: [0.40891143 0.08923628 0.08235639 0.06329002 0.05245407]
2025-10-23 00:42:28,815 - core.pca_initialization - INFO -   ‚úì PCA initialization computed
2025-10-23 00:42:28,815 - core.pca_initialization - INFO -   Using sparse_gfa_fixed parameterization (non-centered)
2025-10-23 00:42:28,917 - core.pca_initialization - INFO -   Initializing lmbZ: shape (86, 5)
2025-10-23 00:42:28,939 - core.pca_initialization - INFO -   Initializing lmbW: shape (1808, 5)
2025-10-23 00:42:28,961 - core.pca_initialization - INFO -   Initializing cZ_tilde: shape (1, 5)
2025-10-23 00:42:28,961 - core.pca_initialization - INFO -   Initializing cW_tilde: shape (2, 5)
2025-10-23 00:42:28,982 - core.pca_initialization - INFO -   Initializing sigma: shape (1, 2)
2025-10-23 00:42:28,992 - core.pca_initialization - INFO - ‚úì Created NumPyro init params for sparse_gfa_fixed
2025-10-23 00:42:28,992 - core.pca_initialization - INFO -   Total parameters initialized: 10
2025-10-23 00:42:28,992 - core.pca_initialization - INFO -   Parameter names: ['tauZ', 'Z_raw', 'W_raw', 'tauW1', 'tauW2', 'lmbZ', 'lmbW', 'cZ_tilde', 'cW_tilde', 'sigma']
2025-10-23 00:42:28,992 - core.pca_initialization - INFO -     tauZ: shape=(1, 5), dtype=float32
2025-10-23 00:42:28,992 - core.pca_initialization - INFO -     Z_raw: shape=(86, 5), dtype=float32
2025-10-23 00:42:28,992 - core.pca_initialization - INFO -     W_raw: shape=(1808, 5), dtype=float32
2025-10-23 00:42:28,992 - core.pca_initialization - INFO -     tauW1: shape=(), dtype=float32
2025-10-23 00:42:28,992 - core.pca_initialization - INFO -     tauW2: shape=(), dtype=float32
2025-10-23 00:42:28,992 - core.pca_initialization - INFO -     lmbZ: shape=(86, 5), dtype=float32
2025-10-23 00:42:28,992 - core.pca_initialization - INFO -     lmbW: shape=(1808, 5), dtype=float32
2025-10-23 00:42:28,992 - core.pca_initialization - INFO -     cZ_tilde: shape=(1, 5), dtype=float32
2025-10-23 00:42:28,992 - core.pca_initialization - INFO -     cW_tilde: shape=(2, 5), dtype=float32
2025-10-23 00:42:28,992 - core.pca_initialization - INFO -     sigma: shape=(1, 2), dtype=float32
2025-10-23 00:42:28,992 - experiments.robustness_testing - INFO -    Using PCA initialization for MCMC (model_type=sparse_gfa_fixed)
2025-10-23 00:42:28,992 - experiments.robustness_testing - INFO - ================================================================================
2025-10-23 00:42:28,992 - experiments.robustness_testing - INFO - STARTING MCMC SAMPLING
2025-10-23 00:42:28,992 - experiments.robustness_testing - INFO - ================================================================================
2025-10-23 00:42:28,992 - experiments.robustness_testing - INFO - This will run 50 warmup + 100 sampling iterations
2025-10-23 00:42:33,161 - optimization.profiler - INFO - Performance: seed_42: 4.341s, 1.52GB peak, 125.0% CPU
2025-10-23 00:42:33,161 - experiments.framework - INFO - üßπ Performing comprehensive memory cleanup...
2025-10-23 00:42:33,237 - experiments.framework - INFO - Garbage collection freed 0 objects
2025-10-23 00:42:33,474 - experiments.framework - INFO - GPU memory cleanup attempted
2025-10-23 00:42:34,476 - experiments.framework - INFO - ‚úÖ Comprehensive memory cleanup completed
